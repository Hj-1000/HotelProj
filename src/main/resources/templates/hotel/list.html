<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>NTT 호텔 - 호텔 목록</title>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://kit.fontawesome.com/b17b1596b8.js" crossorigin="anonymous"></script>
    <link rel ="stylesheet" href="/assets/fonts/fontawesome-all.min.css">
    <link rel ="stylesheet" href="/assets/css/bootstrap.min.css">
    <link rel ="stylesheet" href="/assets/bootstrap/css/bootstrap.min.css">

    <!-- 부트스트랩 아이콘 -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.1/font/bootstrap-icons.css">

    <link rel="stylesheet" th:href="@{/css/user.css}">
    <link rel="stylesheet" th:href="@{/css/roomList.css}">
    <link rel="stylesheet" th:href="@{/css/hotelList.css}">

    <style>

        .banner-container {
            width:100%;
            height:400px;
            overflow:hidden;
            margin:0 auto;
        }
        .bannerImg {
            width:100%;
            height:100%;
            object-fit:cover;
        }

        .hotel-img {
            width: 100%;          /* 부모 컨테이너의 가로 크기 100%로 설정 */
            height: 230px;        /* 세로 크기 230px로 고정 */
            overflow: hidden;     /* 이미지가 영역을 넘을 경우 잘리도록 설정 */
            position: relative;   /* 자식 요소의 위치를 정하기 위해 relative 설정 */
            margin: 0 auto 5px auto;
        }

        .hotelImg {
            position: absolute;   /* 이미지의 위치를 절대적으로 설정 */
            top: 50%;             /* 상단 중앙으로 설정 (위에서 50% 지점) */
            left: 50%;            /* 좌측 중앙으로 설정 (좌에서 50% 지점) */
            width: 100%;          /* 가로 크기를 100%로 맞추기 */
            height: 100%;         /* 세로 크기를 100%로 맞추기 */
            object-fit: cover;    /* 이미지가 영역을 꽉 채우고 잘리도록 설정 */
            transform: translate(-50%, -50%); /* 이미지 중앙 정렬 */
        }

        .image-box {
            position: relative;  /* 이미지 박스에 상대적 위치를 설정 */
            width: 100%;         /* 가로 크기 100% */
            height: 100%;        /* 세로 크기 100% */
        }

        .hover-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.5); /* 어두운 반투명 배경 */
            opacity: 0;
            transition: opacity 0.3s ease;
            visibility: hidden;  /* 처음에는 오버레이 숨기기 */
        }

        .image-box:hover .hover-overlay {
            opacity: 1;          /* 이미지 박스를 hover 할 때만 오버레이 보이게 */
            visibility: visible; /* hover 시 오버레이 표시 */
        }

        .btn-hover {
            text-decoration: none;
            font-size: 16px;
            font-weight: bold;
            padding: 10px 20px;
            color: white; /* 버튼 텍스트 흰색 */
            background-color: transparent; /* 투명 배경 */
            border: 2px solid white; /* 흰색 테두리 */
            border-radius: 5px;
        }

        .btn-hover:hover {
            background-color: rgba(255, 255, 255, 0.7); /* hover 시 살짝 흰색 배경 */
            border: 2px solid #f1f1f1;
        }


        .modal-header {
            display: flex;
            justify-content: center; /* 가로 가운데 정렬 */
            align-items: center; /* 세로 중앙 정렬 */
            width: 100%; /* 전체 너비 사용 */
        }
        .modal-title {
            flex: 1; /* 제목을 가운데 정렬하도록 유연하게 확장 */
            text-align: center; /* 텍스트 가운데 정렬 */
        }
        .mapBtn {
            width: 300px;
        }



        .location-link {
            text-decoration: none;
            color: #282f32;
            margin-bottom: 5px
        }

        /*.hotel-price {*/
        /*    font-size: 1.25rem;*/
        /*    font-weight: bold;*/
        /*    margin: 0;*/
        /*    flex-grow: 1;*/
        /*}*/

    </style>


    <script th:inline="javascript">

        document.addEventListener('DOMContentLoaded', function() {
            const buttons = document.querySelectorAll('.btn-group-vertical button');

            buttons.forEach(button => {
                button.addEventListener('click', function() {
                    // 모든 지역 리스트 숨기기
                    const regionLists = document.querySelectorAll('.region-list');
                    regionLists.forEach(list => {
                        list.style.display = 'none';
                    });

                    // 클릭한 버튼에 해당하는 지역 리스트 보이기
                    const target = button.getAttribute('data-target');
                    const targetList = document.querySelectorAll(`.region-list.${target}`);
                    targetList.forEach(list => {
                        list.style.display = 'block';
                    });
                });
            });
        });

        window.onload = function() {

            // 세션에서 message 값을 가져옴
            var message = [[${message}]];

            // message가 null이 아니면 알림창을 띄우고 세션에서 삭제
            if (message !== null && message !== '') {
                alert(message);
            }

            const priceElement = document.getElementById("formattedPrice");
            if (priceElement && priceElement.innerText) {
                const price = parseInt(priceElement.innerText, 10);
                if (!isNaN(price)) {
                    priceElement.innerText = price.toLocaleString();
                }
            }

            $(".delBtn").hide();

            $(".likeBtn").each(function () {
                var hotelId = $(this).data("hotel-id");

                $.ajax({
                    url: "/like/check/" + hotelId, // ✅ hotelId를 URL에 포함
                    type: "GET",
                    success: function (isLiked) {
                        console.log("찜 여부 확인 결과:", hotelId, isLiked); // ✅ true 또는 false 확인

                        var likeBtn = $(".likeBtn[data-hotel-id='" + hotelId + "']");
                        var delBtn = $(".delBtn[data-hotel-id='" + hotelId + "']");

                        if (isLiked) {
                            likeBtn.hide();
                            delBtn.show();
                        } else {
                            likeBtn.show();
                            delBtn.hide();
                        }
                    },
                    error: function (xhr) {
                        if (xhr.status === 401) {
                            // 비로그인 사용자일 경우
                            console.log("비로그인 사용자입니다.");  // "비로그인 사용자" 로그 출력
                        } else {
                            console.error("찜 여부 확인 AJAX 요청 실패:", xhr.status, xhr.responseText);
                        }
                    }
                });
            });

        }

        $(document).on("click", ".likeBtn", function (event) {
            var hotelId = $(this).data("hotel-id");

            console.log("찜 버튼 클릭됨! 호텔 ID:", hotelId);

            if (!hotelId) {
                console.error("호텔 ID가 올바르게 설정되지 않았습니다.");
                alert("오류: 호텔 ID를 찾을 수 없습니다.");
                return;
            }

            $.ajax({
                url: "/like/register",
                type: "POST",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ hotelId: hotelId }),
                beforeSend: function () {
                    console.log("AJAX 요청 전송 중...");
                },
                success: function () {
                    console.log("찜 등록 성공!");
                    alert("해당 호텔이 스크랩 되었습니다.");
                    location.reload();
                },
                error: function (xhr) {
                    console.error("찜 등록 실패:", xhr.status, xhr.responseText);
                    alert("찜 등록 실패: " + xhr.responseText);
                }
            });
        });


        function delLike(btn) {
            var hotelId = $(btn).data("hotel-id");
            console.log("호텔 ID:", hotelId); // 여기서 호텔 ID가 제대로 출력되는지 확인

            if (!hotelId) {
                alert("삭제할 호텔 ID가 없습니다.");
                return;
            }

            var paramData = { hotelId: hotelId };

            $.ajax({
                url: "/like/delete",
                type: "POST",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify(paramData),
                success: function () {
                    alert("스크랩이 취소 되었습니다.");
                    $(btn).hide();
                    $(btn).siblings(".likeBtn").show();
                },
                error: function (xhr) {
                    console.error("삭제 실패:", xhr.responseText);
                    alert("삭제 실패: " + xhr.responseText);
                }
            });
        }




        document.addEventListener("DOMContentLoaded", function () {
            var moBtn = document.querySelectorAll(".modalBtn");  // 버튼을 모든 요소로 처리
            var modalElement = document.getElementById("myModal"); // 모달 요소 가져오기
            var modal = new bootstrap.Modal(modalElement); // 부트스트랩 Modal 객체 생성

            // 모달 버튼 클릭 시
            moBtn.forEach(function (btn) {
                btn.addEventListener("click", function () {
                    console.log("모달 진입");

                    modal.show(); // 모달 열기
                });
            });

        })


        // 현재 선택된 버튼을 추적하는 변수
        var currentButton = null;

        function changeButtonClass(button) {
            // 만약 이미 선택된 버튼이 있다면
            if (currentButton) {
                // 그 버튼의 클래스를 다시 btn-light로 변경
                currentButton.classList.remove('btn-dark');
                currentButton.classList.add('btn-light');
            }

            // 현재 클릭한 버튼을 'btn-dark'로 변경
            button.classList.remove('btn-light');
            button.classList.add('btn-dark'); // 또는 'btn-secondary'로 변경 가능

            // 현재 버튼을 추적
            currentButton = button;
        }

    </script>

</head>
<body>
<div th:replace="~{fragments/header::header}"></div>
<div layout:fragment="content">
    <!-- 룸 배너 이미지 -->
    <section class="banner-container hotel-bnr ">
        <img src="/img/bg_membership.jpg" alt="Hotel Banner" class="bannerImg">
    </section>

    <!-- hotel List Section -->
    <section class="py-5">
        <div class="container">
            <div class="container1 mt-3 mb-5">
                <br>
                <h2 class="d-flex justify-content-center mb-3">어디로 갈까요?</h2>
                <div class="d-flex justify-content-center mt-2" role="search">
                    <button type="button" class="form-control w-60 me-1 modalBtn" style="text-align: left;" aria-label="Search">
                        <!--<i class="fa-solid fa-location-dot"></i>-->
                        <h5 style="padding-top: 10px;"><i class="bi bi-geo-alt-fill"></i> 지역 선택</h5>
                    </button>
                    <button class="btn btn-outline-success mapBtn" type="button">
                        <i class="bi bi-map-fill"></i>
                        <br><span style="font-size: small">내 주변</span>
                    </button>
                </div>

                <form action="/hotel/list" method="get" class="mt-3">
                    <div class="row g-3 align-items-center">
                        <div class="col-md-6">
                            <select name="searchType" class="form-select" style="height: 50px;">
                                <option value="name" th:selected="${searchType == 'name'}">호텔명</option>
                                <option value="address" th:selected="${searchType == 'address'}">주소</option>
                                <option value="rating" th:selected="${searchType == 'rating'}">별점</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <input type="text" name="keyword" class="form-control" placeholder="검색어를 입력하세요" style="height: 50px;">
                        </div>
                    </div>
                    <!-- 조회 버튼 -->
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-dark w-25" style="height: 50px;" th:formaction="@{ /hotel/list(searchType=${searchType}, keyword=${keyword})}">조 회</button>
                    </div>
                </form>


            </div>




            <div id="hotel-list">

                <!-- 호텔이 있을 경우 -->
                <div th:if="${hotelDTOS != null or !#lists.isEmpty(hotelDTOS)}" class="row hotel-list">
                    <div class="col-md-4" th:each="data : ${hotelDTOS}">
                        <div class="room-card">
                            <div class="image-box">
                                <!--등록한 사진이 있을 때-->
                                <th:block th:if="${data.hotelImgDTOList != 0}">
                                    <div class="hotel-img">
                                        <!-- 이미지 경로(path) -->
                                        <img th:if="${data.hotelImgDTOList != null and !data.hotelImgDTOList.isEmpty()}"
                                             th:src="@{'/upload/' + ${data.hotelImgDTOList[0].imagePath}}"
                                             alt="hotel Image"
                                             class="card-img-top hotelImg" width="100%">
                                    </div>
                                </th:block>
                                <!--등록한 사진이 없을 때-->
                                <th:block th:unless="${data.hotelImgDTOList.size() != 0}">
                                    <div class="hotel-img">
                                        <img src="/img/default_img.jpg" alt="noImage" class="card-img-top hotelImg" style="width: 300px"/>
                                    </div>
                                </th:block>

                                <!-- 이미지 박스 위에 오버레이 버튼 -->
                                <div class="hover-overlay">
                                    <a th:href="@{/hotel/read(hotelId=${data.hotelId})}" class="btn btn-hover">자세히 보기</a>
                                </div>
                            </div>

                            <div class="room-text">
                                <div class="d-flex justify-content-start gap-2 mb-2">
                                    <!-- 지역버튼 -->
                                    <div style="display: flex; gap: 5px;">
                                        <a th:href="@{'/hotel/list?searchType=location&keyword=' + ${data.hotelLocation}}" style="text-decoration: none">
                                            <div class="badge bg-secondary" th:text="${data.hotelLocation}">지역</div>
                                        </a>
                                    </div>
                                </div>
                                <h4 th:text="${data.hotelName}" class="card-title mb-2" style="white-space: nowrap; overflow: hidden; text-overflow: ellipsis;"></h4>
                                <p th:text="'체크인-체크아웃: ' + ${data.hotelCheckIn} + '시 ~ ' + ${data.hotelCheckOut} + '시'" class="card-text"></p>
                                <input type="hidden" class="hotelId" th:value="${data.hotelId}">
                                <div class="room-actions" style="margin-top: -5px">

                                    <p class="room-price mb-0"
                                       th:text="${data.CheapestRoomPrice != null ? data.CheapestRoomPrice + ' KRW' + '~' : '가격 미정'}"></p>

                                    <button class="btn btn-outline-danger likeBtn"  th:data-hotel-id="${data.hotelId}" onclick="addLike()" style="width: 50px; height: 50px">
                                        <!--<i class="fa-regular fa-heart"></i>-->

                                        <i class="bi bi-heart" style="margin: auto; text-align: center"></i>

                                    </button>
                                    <button class="btn btn-outline-danger delBtn"  th:data-hotel-id="${data.hotelId}" onclick="delLike(this)" style="width: 50px; height: 50px">
                                        <!--<i class="fa fa-heart" aria-hidden="true"></i>-->

                                        <i class="bi bi-heart-fill" style="margin: auto; text-align: center"></i>

                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- 호텔이 없을 경우 -->
                <div th:if="${hotelDTOS == null or #lists.isEmpty(hotelDTOS)}" class="text-center mt-4">
                    <p class="text-muted">등록 된 호텔이 없습니다.</p>
                </div>


                <!-- 페이지네이션 -->
                <div class="d-flex justify-content-center">
                    <ul class="pagination">
                        <!-- 시작 버튼 -->
                        <li class="page-item" th:unless="${pageInfo.currentPage == 1}">
                            <a class="page-link" th:href="@{/hotel/list(page=1)}">시작</a>
                        </li>

                        <!-- 이전 버튼 -->
                        <li class="page-item" th:unless="${pageInfo.currentPage == 1}">
                            <a class="page-link" th:href="@{/hotel/list(page=${pageInfo.prevPage})}">이전</a>
                        </li>

                        <!-- 페이지 번호 -->
                        <th:block th:each="num : ${#numbers.sequence(pageInfo.startPage, pageInfo.endPage, 1)}">
                            <li class="page-item" th:unless="${num == pageInfo.currentPage}">
                                <a class="page-link" th:href="@{/hotel/list(page=${num})}" th:text="${num}">1</a>
                            </li>
                            <li class="page-item active" th:if="${num == pageInfo.currentPage}">
                                <a class="page-link" th:href="@{/hotel/list(page=${num})}" th:text="${num}">[[${num}]]</a>
                            </li>
                        </th:block>

                        <!-- 다음 버튼 -->
                        <li class="page-item" th:unless="${pageInfo.currentPage >= pageInfo.lastPage}">
                            <a class="page-link" th:href="@{/hotel/list(page=${pageInfo.nextPage})}">다음</a>
                        </li>

                        <!-- 끝 버튼 -->
                        <li class="page-item" th:unless="${pageInfo.currentPage == pageInfo.lastPage}">
                            <a class="page-link" th:href="@{/hotel/list(page=${pageInfo.lastPage})}">끝</a>
                        </li>
                    </ul>
                </div>


            </div>
        </div>

    </section>



    <div class="modal" tabindex="-1" id="myModal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h4 class="modal-title">지역 선택✈</h4>

                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-3">
                            <div class="btn-group-vertical" role="group" aria-label="Vertical button group" style="width: 100%; margin-right: -5px">
                                <button type="button" class="btn btn-light " data-target="su" onclick="changeButtonClass(this)">서울</button>
                                <button type="button" class="btn btn-light " data-target="gk" onclick="changeButtonClass(this)">경기</button>
                                <button type="button" class="btn btn-light " data-target="ic" onclick="changeButtonClass(this)">인천</button>
                                <button type="button" class="btn btn-light " data-target="jj" onclick="changeButtonClass(this)">제주</button>
                                <button type="button" class="btn btn-light " data-target="bs" onclick="changeButtonClass(this)">부산</button>
                                <button type="button" class="btn btn-light " data-target="dg" onclick="changeButtonClass(this)">대구</button>
                                <button type="button" class="btn btn-light " data-target="gj" onclick="changeButtonClass(this)">광주</button>
                                <button type="button" class="btn btn-light " data-target="dj" onclick="changeButtonClass(this)">대전</button>
                                <button type="button" class="btn btn-light " data-target="us" onclick="changeButtonClass(this)">울산</button>
                                <button type="button" class="btn btn-light " data-target="gw" onclick="changeButtonClass(this)">강원</button>
                                <button type="button" class="btn btn-light " data-target="gs" onclick="changeButtonClass(this)">경상</button>
                                <button type="button" class="btn btn-light " data-target="je" onclick="changeButtonClass(this)">전라</button>
                                <button type="button" class="btn btn-light " data-target="cc" onclick="changeButtonClass(this)">충청</button>
                            </div>
                        </div>
                        <div class="col-9">
                            <!-- 서울 -->
                            <ul class="region-list su list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=강남/역삼/삼성">강남/역삼/삼성</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=신사/청담/압구정">신사/청담/압구정</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서초/교대/사당">서초/교대/사당</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=잠실/송파/강동">잠실/송파/강동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=홍대/합정/상암/마포">홍대/합정/상암/마포</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=구로/신도림/금천">구로/신도림/금천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=김포공항/강서/양천">김포공항/강서/양천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=건대입구/성수/성동">건대입구/성수/성동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=종로/광화문/청계천/명동">종로/광화문/청계천/명동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=동대문/을지로/중구">동대문/을지로/중구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=용산/이태원/여의도">용산/이태원/여의도</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=노원/중랑/도봉">노원/중랑/도봉</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=성북/광진/강북">성북/광진/강북</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=은평/서대문">은평/서대문</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=동작/관악">동작/관악</a>
                            </ul>

                            <!-- 부산 -->
                            <ul class="region-list bs list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=해운대/수영/남구">해운대/수영/남구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=중구/남포/영도">중구/남포/영도</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=동래/연제/금정">동래/연제/금정</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=사하/강서/사상">사하/강서/사상</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=북구/울주/기장">북구/울주/기장</a>
                            </ul>
                            <!-- 제주 -->
                            <ul class="region-list jj list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=제주/한림/애월">제주/한림/애월</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서귀포/중문/대정">서귀포/중문/대정</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=성산/표선/송악산">성산/표선/송악산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=구좌/조천/용담동">구좌/조천/용담동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=남원/한경/성산">남원/한경/성산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=제주공항/서광로/동문시장">제주공항/서광로/동문시장</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=안덕면/호근동/대포">안덕면/호근동/대포</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=이호동/용수리/제주대학교">이호동/용수리/제주대학교</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=중산간도로/천지연폭포/미로공원">중산간도로/천지연폭포/미로공원</a>
                            </ul>
                            <!-- 경기 -->
                            <ul class="region-list gk list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=수원">수원</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=고양">고양</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=용인">용인</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=성남">성남</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=화성">화성</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=부천">부천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=광명/시흥">광명/시흥</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=하남/광주">하남/광주</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=안양/군포/의왕/과천">안양/군포/의왕/과천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=안산/오산">안산/오산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=평택/이천/여주/안성">평택/이천/여주/안성</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=의정부/남양주/구리">의정부/남양주/구리</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=가평/양평/여주">가평/양평/여주</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=파주/양주/동두천">파주/양주/동두천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=포천/연천">포천/연천</a>
                            </ul>
                            <!-- 인천 -->
                            <ul class="region-list ic list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=송도/연수/남동">송도/연수/남동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=부평/계양">부평/계양</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=중구/동구/미추홀">중구/동구/미추홀</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서구/강화/옹진">서구/강화/옹진</a>
                            </ul>

                            <!-- 대구 -->
                            <ul class="region-list dg list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=중구/동성로/남구">중구/동성로/남구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=수성구/달서구/북구">수성구/달서구/북구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서구/동구/달성군">서구/동구/달성군</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=군위군/고령군/청도군/칠곡군">군위군/고령군/청도군/칠곡군</a>
                            </ul>

                            <!-- 광주 -->
                            <ul class="region-list gj list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=동구/서구/남구">동구/서구/남구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=북구/광산구">북구/광산구</a>
                            </ul>

                            <!-- 대전 -->
                            <ul class="region-list dj list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=유성구/서구/중구">유성구/서구/중구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=동구/대덕구">동구/대덕구</a>
                            </ul>

                            <!-- 울산 -->
                            <ul class="region-list us list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=남구/중구/동구">남구/중구/동구</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=북구/울주군">북구/울주군</a>
                            </ul>

                            <!-- 강원 -->
                            <ul class="region-list gw list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=강릉/동해/삼척">강릉/동해/삼척</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=양양/속초/고성">양양/속초/고성</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=춘천/홍천/평창">춘천/홍천/평창</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=원주/횡성/영월">원주/횡성/영월</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=정선/태백/사북">정선/태백/사북</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=철원/화천/양구/인제">철원/화천/양구/인제</a>
                            </ul>
                            <!-- 충청 -->
                            <ul class="region-list cc list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=대전">청주/충주/제천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=천안/아산/당진">천안/아산/당진</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=보은/옥천/영동">보은/옥천/영동</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=진천/음성/증평">진천/음성/증평</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=괴산/단양">괴산/단양</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=논산/계룡/금산">논산/계룡/금산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서산/홍성/예산">서산/홍성/예산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=서천/보령">서천/보령</a>
                            </ul>
                            <!-- 전라 -->
                            <ul class="region-list je list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=전주/군산/익산">전주/군산/익산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=여수/순천/광양">여수/순천/광양</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=목포/나주/무안">목포/나주/무안</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=목포/나주/무안">정읍/남원/완주</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=목포/나주/무안">담양/순천/해남</a>
                            </ul>
                            <!-- 경상 -->
                            <ul class="region-list gs list-group" style="display: none;">
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=포항/경주/영천">포항/경주/영천</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=구미/안동/문경">구미/안동/문경</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=김천/상주/칠곡">김천/상주/칠곡</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=영주/의성/청송">영주/의성/청송</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=울진/영덕">울진/영덕</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=창원/김해/양산">창원/김해/양산</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=진주/사천/밀양">진주/사천/밀양</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=통영/거제/고성">통영/거제/고성</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=함안/의령/창녕">함안/의령/창녕</a>
                                <a class="location-link list-group-item list-group-item-action" href="/hotel/list?searchType=location&keyword=하동/남해">하동/남해</a>
                            </ul>
                        </div>
                    </div>
                </div>


                <!--<div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-bs-dismiss="modal" aria-label="Close">닫기</button>
                </div>-->
            </div>
        </div>
    </div>

    <!--내 위치 가져오는 스크립트 2025-03-05 추가-->
    <script type="text/javascript"
            src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=0cb0450151c2b892da76c0d5dcd6535a&libraries=services"></script>

    <script>
        document.querySelector('.mapBtn').addEventListener('click', function() {
            // Geolocation API로 사용자의 위치를 받아오기
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(function(position) {
                    const userLat = position.coords.latitude;
                    const userLong = position.coords.longitude;

                    // 카카오맵 Geocoder를 사용해 위도, 경도를 주소로 변환
                    var geocoder = new daum.maps.services.Geocoder();
                    var latlng = new daum.maps.LatLng(userLat, userLong);

                    // 경도(x), 위도(y) 순서로 전달
                    geocoder.coord2RegionCode(latlng.getLng(), latlng.getLat(), function(result, status) {
                        console.log("API 호출 결과:", result); // 결과를 콘솔로 확인
                        console.log("API 상태:", status); // 상태를 콘솔로 확인

                        if (status === daum.maps.services.Status.OK) {
                            // 결과가 충분한지 확인
                            if (result && result[0] && result[0].address_name) { // result[0].address_name 사용
                                // 첫 번째 주소만 추출 (도, 시군구)
                                var region = result[0].address_name; // 첫 번째 지역 정보를 사용

                                // 예시: 경기도 부천시 소사구 심곡본동 -> 경기도 + 부천시
                                var regionParts = region.split(' '); // 공백을 기준으로 분리
                                var province = regionParts[0]; // 도 (경기도)
                                var city = regionParts[1]; // 시군구 (부천시)

                                if (province === '서울특별시' || province === '부산광역시' || province === '대구광역시' || province === '인천광역시' || province === '광주광역시' || province === '대전광역시' || province === '울산광역시' || province === '세종특별자치시') {
                                    // 서울, 특별자치도, 대도시에서는 구를 포함
                                    var city = regionParts[1]; // 구 포함된 시군구
                                } else {
                                    // 그 외 지역에서는 구를 제외
                                    var cityParts = city.split(' ');
                                    city = cityParts[0]; // 구를 제외한 시군구
                                }


                                // "도"를 빼고 처리 (예: "경기도" -> "경기")
                                if (province.endsWith('도')) {
                                    province = province.slice(0, -1); // "도"를 잘라내기
                                }

                                // 도와 시군구를 기반으로 URL로 이동
                                var searchKeyword = province + ' ' + city;
                                var encodedKeyword = encodeURIComponent(searchKeyword); // 공백을 +로 변경

                                // 검색 URL로 리다이렉션
                                window.location.href = "/hotel/list?searchType=address&keyword=" + encodedKeyword;
                            } else {
                                alert('주소를 가져오는 데 실패했습니다. (주소 정보가 없습니다)');
                            }
                        } else {
                            alert('주소를 가져오는 데 실패했습니다. 상태: ' + status);
                        }
                    });
                }, function(error) {
                    alert('위치 정보 조회에 실패했습니다.');
                });
            } else {
                alert('Geolocation을 지원하지 않는 브라우저입니다.');
            }
        });
    </script>


</div>
<div th:replace="~{fragments/footer::footer}"></div>
</body>
</html>
